#!/bin/bash
set -eo pipefail

QUERIES=("ab" "abcd" "abcdef" "abcdefgh" "abcdefghij" "abcdefghijkl")
SUMMARY_SIZES=(500) 
TIME_WINDOW_SIZES=(100) 
STREAM_SIZES=(10000)
TIMES_TO_LIVE=(10000)
PROB_DISTRIBUTIONS=("uniform")
EVAL_TIMESTAMPS_COUNTS=(50)
EVAL_TIMESTAMPS_PROB_DISTS=("poisson")
NUM_OF_RUNS=(10)

SEEDS=(8334 23539 27030 22035 10074 22763 10227 1756 18613 2616 32108 3208 20515 10734 21229 27011 3445 31346 28816 14198 29427 7068 29103 15702 10152 17389 6123 14807 20860 9956 13014 6948 19093 4388 13748 26320 11467 16463 19879 600 26770 31381 16542 12806 27455 32040 16042 22990 18586 2632 14198 20515 6948 21229 12806 10227 2632 6123 16542 28816 26320 19879 17389 26770 10734 32108 19093 22990 16463 11467 29103 31381 22035 9956 18613 3208 13014 3445 20860 18586 16042 32040 600 29427 27011 15702 27455 22763 4388 27030 8334 2616 14807 23539 1756 10074 13748 10152 31346 7068 18613 11467 6948 7068 17389 15702 10227 16042 22035 19093 29103 16542 22990 14198 27030 19879 8334 10074 12806 26770 16463 1756 13014 9956 2632 3208 20515 2616 13748 27455 26320 21229 600 31346 14807 31381 22763 32040 23539 18586 32108 28816 10152 4388 20860 29427 10734 3445 6123 27011 15702 2616 1756 23539 12806 18586 26320 20515 16042 32108 22990 29103 19879 14807 11467 4388 6948 17389 18613 19093 600 13014 16463 9956 21229 20860 2632 8334 14198 26770 10074 29427 6123 10227 28816 31381 32040 3445 27011 31346 10734 7068 22035 22763 3208 10152 27455 27030 16542 13748 10152 29103 15702 12806 22990 2616 26320 3208 10227 14807 23539 31381 8334 32040 13014 1756 31346 19879 18586 13748 19093 18613 21229 27011 26770 17389 20515 28816 32108 16042 22035 27030 11467 9956 10074 20860 14198 16463 2632 600 3445 4388 27455 16542 6948 29427 22763 7068 6123 10734 22990 2616 32108 14198 27455 6123 20860 10227 10734 7068 22763 26770 15702 18586 13014 31381 16542 8334 1756 13748 28816 26320 22035 600 10152 23539 16463 16042 29427 20515 27030 6948 14807 27011 12806 21229 18613 31346 29103 2632 19093 3445 11467 4388 32040 17389 19879 10074 9956 3208)

rm -f report.csv
rm -f seeds.txt

for query in "${QUERIES[@]}"
do
seed_index=0
	for time_window_size in "${TIME_WINDOW_SIZES[@]}"
	do
		for summary_size in "${SUMMARY_SIZES[@]}"
		do
			for stream_size in "${STREAM_SIZES[@]}"
			do
				for time_to_live in "${TIMES_TO_LIVE[@]}"
				do
					for prob_distribution in "${PROB_DISTRIBUTIONS[@]}"
					do
						for eval_timestamp_count in "${EVAL_TIMESTAMPS_COUNTS[@]}"
						do
							for eval_timestamp_dist in "${EVAL_TIMESTAMPS_PROB_DISTS[@]}"
							do
								for ((run=1; run<=NUM_OF_RUNS; run++))
								do
                                                                        RANDOM_SEED=${SEEDS[$seed_index]}
									((seed_index += 1))
									bash run_test.sh \
										${summary_size} \
										${time_window_size} \
										${stream_size} \
										${time_to_live} \
										${prob_distribution} \
										${eval_timestamp_count} \
										${eval_timestamp_dist} \
										${RANDOM_SEED} \
										"${query}" >/dev/null &
								done
							done
						done
					done
				done
			done
		done
	done
done

wait
